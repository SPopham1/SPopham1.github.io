---
import Layout from "../layouts/Layout.astro";
import projects from "../data/projects";
import { Image } from "astro:assets";

import raytracerImg from "../assets/images/raytracer.png";
import chessImg from "../assets/images/chess.png";
import bezierImg from "../assets/images/bezier.png";
import gestureImg from "../assets/images/gesture-controller.png";
import alarmImg from "../assets/images/alarm-app.png";
import weatherImg from "../assets/images/weather.png";
import smartshopImg from "../assets/images/smartshop.png";

const projects = [
  {
    title: "Chess Engine with AI Search",
    description:
      "Alpha-beta pruning, quiescence search, MVV-LVA ordering, and transposition tables optimized for search depth.",
    image: chessImg,
    link: "/projects/chess",
    tags: ["Python", "Search", "AI"],
    priority: "High",
  },
  {
    title: "Hand Gesture Volume Controller",
    description:
      "Background computer vision system for volume control using hand landmarks and tray controls.",
    image: gestureImg,
    link: "/projects/gesture-controller",
    tags: ["Computer Vision", "MediaPipe", "Python"],
    priority: "Medium",
  },
  {
    title: "Smart Shopping Assistant",
    description:
      "Create sharable shopping lists and generate efficient in-store routes.",
    image: smartshopImg,
    link: "/projects/smartshop",
    tags: ["Flutter", "Routing", "UX"],
    priority: "Medium",
  },
  {
    title: "WebGL Projects",
    description: "WebGL rendering of Bezier curves and the Utah teapot",
    image: bezierImg,
    link: "/projects/visual",
    tags: ["WebGL", "Graphics", "Math"],
    priority: "Medium",
  },
  {
    title: "Physical Shutoff Alarm App",
    description:
      "Android app with alarms, notifications, local persistence, and ML-based activity verification using pose detection. (Code currently being withheld for grading)",
    image: alarmImg,
    link: "/projects/alarm-app",
    tags: ["Android", "ML", "Mobile"],
    priority: "Low",
  },
  {
    title: "Python Weather App",
    description:
      "Lightweight desktop application for retrieving and displaying real-time weather data.",
    image: weatherImg,
    link: "/projects/weather",
    tags: ["Python", "PyQt", "APIs"],
    priority: "Medium",
  },
  {
    title: "Physically Based Raytracer",
    description:
      "C++ raytracer implementing physically based lighting, reflections, refractions, and global illumination.",
    image: raytracerImg,
    link: "/projects/raytracer",
    tags: ["C++", "Rendering", "Graphics"],
    priority: "High",
  },
];
---

<Layout title="Sam Popham | Portfolio" projects={projects}>
  <header
    class="bg-white/85 dark:bg-slate-800/85 backdrop-blur-[10px] border-b border-gray-200 dark:border-gray-700 py-10 px-5 text-center transition-all duration-300"
  >
    <h1 class="text-5xl font-bold tracking-tight m-0">Sam Popham</h1>
    <p class="text-lg my-2.5">Computer Science Student | University of Bath</p>
    <p class="subtitle text-[0.95rem] opacity-85">
      Python • Java • C++ • AI & Visual Computing
    </p>
  </header>

  <section
    class="w-[calc(100%-40px)] max-w-none mx-auto my-10 px-7 py-8 bg-white/70 dark:bg-slate-800/65 backdrop-blur-[18px] rounded-2xl border border-white/35 dark:border-white/8 shadow-lg relative z-10"
  >
    <h2
      class="text-3xl font-bold tracking-tight border-b-2 border-gray-200 dark:border-gray-700 pb-2 mb-8"
    >
      About Me
    </h2>
    <p class="mb-4">
      I am a second-year Computer Science student at the University of Bath,
      currently on track for a First Class degree. My focus is on the <strong
        >intersection of scalable software engineering and data-driven
        intelligence</strong
      > - building systems that are as efficient as they are insightful.
    </p>
    <p class="mb-4">
      My work ranges from optimizing algorithmic performance in custom-built
      engines to implementing machine learning models from the ground up. I am
      driven by the challenge of turning complex, real-world data into
      high-performance digital tools.
    </p>
    <p>
      Beyond the code, I'm an effective communicator with experience in
      high-pressure environments, dedicated to bridging the gap between
      technical complexity and business impact.
    </p>
  </section>

  <section
    id="skills"
    class="w-[calc(100%-40px)] max-w-none mx-auto my-10 px-7 py-8 bg-white/70 dark:bg-slate-800/65 backdrop-blur-[18px] rounded-2xl border border-white/35 dark:border-white/8 shadow-lg relative z-10"
  >
    <h2
      class="text-3xl font-bold tracking-tight border-b-2 border-gray-200 dark:border-gray-700 pb-2 mb-8"
    >
      Skills & Technologies
    </h2>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-5 mt-5">
      <div
        class="bg-white/90 dark:bg-slate-800/90 p-5 rounded-lg border border-gray-200 dark:border-gray-700 backdrop-blur-[10px]"
      >
        <h3
          class="mt-0 mb-2.5 text-xl font-bold text-blue-600 dark:text-blue-400"
        >
          Languages
        </h3>
        <p class="m-0 text-gray-600 dark:text-gray-400 leading-relaxed">
          <strong>Proficient:</strong> Python, Haskell, JS/CSS, SQL <br />
          <strong>Exposure:</strong> C++, C#, Dart, Java
        </p>
      </div>
      <div
        class="bg-white/90 dark:bg-slate-800/90 p-5 rounded-lg border border-gray-200 dark:border-gray-700 backdrop-blur-[10px]"
      >
        <h3
          class="mt-0 mb-2.5 text-xl font-bold text-blue-600 dark:text-blue-400"
        >
          Frameworks
        </h3>
        <p class="m-0 text-gray-600 dark:text-gray-400 leading-relaxed">
          OpenCV, MediaPipe, Flutter, Astro, WebGL, Firebase
        </p>
      </div>
      <div
        class="bg-white/90 dark:bg-slate-800/90 p-5 rounded-lg border border-gray-200 dark:border-gray-700 backdrop-blur-[10px]"
      >
        <h3
          class="mt-0 mb-2.5 text-xl font-bold text-blue-600 dark:text-blue-400"
        >
          Focus Areas
        </h3>
        <p class="m-0 text-gray-600 dark:text-gray-400 leading-relaxed">
          AI & Machine Learning, Visual Computing, Graphics, DevOps & Workflow
        </p>
      </div>
    </div>
  </section>

  <section
    id="contact"
    class="w-[calc(100%-40px)] max-w-none mx-auto my-10 px-7 py-8 bg-white/70 dark:bg-slate-800/65 backdrop-blur-[18px] rounded-2xl border border-white/35 dark:border-white/8 shadow-lg relative z-10"
  >
    <h2
      class="text-3xl font-bold tracking-tight border-b-2 border-gray-200 dark:border-gray-700 pb-2 mb-8"
    >
      Contact
    </h2>
    <p class="text-lg">
      GitHub: <a
        href="https://github.com/spopham1"
        target="_blank"
        class="text-blue-600 dark:text-blue-400 hover:underline"
        >github.com/spopham1</a
      ><br />
      Email: <a
        href="mailto:skpp21@bath.ac.uk"
        class="text-blue-600 dark:text-blue-400 hover:underline"
        >skpp21@bath.ac.uk</a
      >
    </p>
  </section>

  <section
    id="projects"
    class="w-[calc(100%-40px)] max-w-none mx-auto my-10 px-7 py-8 bg-white/70 dark:bg-slate-800/65 backdrop-blur-[18px] rounded-2xl border border-white/35 dark:border-white/8 shadow-lg relative z-10 overflow-x-hidden p-1"
  >
    <h2
      class="text-3xl font-bold tracking-tight border-b-2 border-gray-200 dark:border-gray-700 pb-2 mb-8"
    >
      My Projects
    </h2>

    <div
      class="grid grid-cols-1 sm:grid-cols-[repeat(auto-fill,minmax(300px,1fr))] gap-6 w-full justify-items-center sm:justify-items-stretch"
    >
      {
        projects.map((project) => (
          <div class="project-card w-full max-w-[400px] sm:max-w-none opacity-0">
            <div class="relative overflow-hidden rounded-xl border border-gray-200 dark:border-gray-700 group bg-gray-100 dark:bg-slate-900 shadow-sm h-full">
              {/* Wrapper to handle both Link and No-Link scenarios with the same UI */}
              <div
                class={`relative h-full ${!project.link ? "cursor-default" : ""}`}
              >
                {project.link ? (
                  <a
                    href={project.link}
                    rel="noopener noreferrer"
                    class="block h-full"
                  >
                    <Image
                      src={project.image}
                      alt={project.title}
                      format="webp"
                      loading="lazy"
                      class="w-full h-auto block transition-transform duration-500 group-hover:scale-105"
                    />
                    <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-all duration-300 p-5 flex flex-col justify-end">
                      <h3 class="text-white text-lg font-bold m-0">
                        {project.title}
                      </h3>
                      <p class="text-gray-200 text-sm mt-1">
                        {project.description}
                      </p>

                      <div class="mt-3 flex flex-wrap gap-2">
                        {project.tags?.map((t) => (
                          <span class="bg-white/20 text-white px-2 py-0.5 rounded text-[11px] font-semibold">
                            {t}
                          </span>
                        ))}
                        {project.priority ? (
                          <span class="ml-1 w-fit bg-white/20 backdrop-blur-md border border-white/30 text-white px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wider">
                            {project.priority}
                          </span>
                        ) : null}
                      </div>
                    </div>
                  </a>
                ) : (
                  <div class="block h-full">
                    <Image
                      src={project.image}
                      alt={project.title}
                      format="webp"
                      class="w-full h-auto block transition-transform duration-500 group-hover:scale-105"
                    />
                    <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-all duration-300 p-5 flex flex-col justify-end">
                      <h3 class="text-white text-lg font-bold m-0">
                        {project.title}
                      </h3>
                      <p class="text-gray-200 text-sm mt-1">
                        {project.description}
                      </p>

                      <div class="mt-3 flex items-center gap-2">
                        <span class="w-fit bg-white/20 backdrop-blur-md border border-white/30 text-white px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wider">
                          Coming Soon
                        </span>
                        <div class="flex flex-wrap gap-2">
                          {project.tags?.map((t) => (
                            <span class="bg-white/20 text-white px-2 py-0.5 rounded text-[11px] font-semibold">
                              {t}
                            </span>
                          ))}
                          {project.priority ? (
                            <span class="ml-1 w-fit bg-white/20 backdrop-blur-md border border-white/30 text-white px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wider">
                              {project.priority}
                            </span>
                          ) : null}
                        </div>
                      </div>
                    </div>
                  </div>
                )}
              </div>
            </div>
          </div>
        ))
      }
    </div>
  </section>

  <footer
    class="text-center py-8 px-5 mt-16 bg-white/85 dark:bg-slate-800/85 border-t border-gray-200 dark:border-gray-700 text-gray-600 dark:text-gray-400 backdrop-blur-[10px]"
  >
    <p>© 2025 Sam Popham</p>
  </footer>

  <script>
    const observerOptions = { threshold: 0.1, rootMargin: "0px 0px -50px 0px" };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          const el = entry.target as HTMLElement;
          el.style.transform = "translateX(0) scale(1)";
          el.style.opacity = "1";
          el.style.filter = "blur(0px)";
          observer.unobserve(el);
        }
      });
    }, observerOptions);

    document.querySelectorAll(".project-card").forEach((card, index) => {
      const el = card as HTMLElement;
      el.style.opacity = "0";
      el.style.filter = "blur(10px)";
      el.style.transform = "translateX(100px) scale(0.98)";
      el.style.transition = "all 0.7s cubic-bezier(0.16, 1, 0.3, 1)";
      el.style.transitionDelay = `${index * 100}ms`;
      observer.observe(el);
    });

    const mobileHoverOptions = {
      threshold: 0.6,
      rootMargin: "-20% 0px -20% 0px",
    };
    const mobileObserver = new IntersectionObserver((entries) => {
      if (window.matchMedia("(pointer: coarse)").matches) {
        entries.forEach((entry) => {
          if (entry.isIntersecting) {
            entry.target.classList.add("active-hover");
          } else {
            entry.target.classList.remove("active-hover");
          }
        });
      }
    }, mobileHoverOptions);

    document
      .querySelectorAll(".project-card")
      .forEach((card) => mobileObserver.observe(card));
  </script>
</Layout>
