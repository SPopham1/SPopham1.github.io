---
import "../styles/tailwind.css";
import "../styles/global.css";
import { Image } from "astro:assets";

import avatarImg from "../assets/images/avatar.jpg";

interface Props {
  title: string;
  noParticles?: boolean;
}

const { title, noParticles = false } = Astro.props;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Preconnect for fonts (fast DNS/TLS) -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

    <!-- Google Fonts (non-blocking with display=swap) -->
    <link
      rel="preload"
      as="style"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
      rel="stylesheet"
      media="print"
      onload="this.media='all'"
    />
    <noscript>
      <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
        rel="stylesheet"
      />
    </noscript>

    <!-- Font Awesome (non-blocking) -->
    <link
      rel="preload"
      as="style"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
      rel="stylesheet"
      media="print"
      onload="this.media='all'"
    />
    <noscript>
      <link
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        rel="stylesheet"
      />
    </noscript>

    <title>{title}</title>
  </head>

  <body
    class="font-inter
      bg-light text-text-main-light
      dark:bg-dark dark:text-text-main-dark
      transition-colors duration-300"
  >
    <!-- Particles -->
    {
      !noParticles && (
        <canvas
          id="particleCanvas"
          class="fixed top-0 left-0 w-full h-full z-0 pointer-events-none"
        />
      )
    }

    <!-- Sidebar (desktop only) -->
    <nav
      class="fixed top-14 left-0 h-[calc(100vh-3.5rem)] w-20
            bg-light/80 dark:bg-dark/80 backdrop-blur-xl
            border-r border-gray-200 dark:border-gray-700
            hidden md:flex flex-col items-center py-6
            z-30"
    >
      <!-- Avatar -->
      <Image
        src={avatarImg}
        alt="Sam Popham"
        width={48}
        height={48}
        loading="eager"
        class="rounded-full mb-8 border border-gray-300 dark:border-gray-600"
      />

      <!-- Links -->
      <a href="#top" class="sidebar-link">
        <i class="fa-solid fa-house"></i>
        <span>Home</span>
      </a>

      <a href="#skills" class="sidebar-link">
        <i class="fa-solid fa-layer-group"></i>
        <span>Skills</span>
      </a>

      <a href="#contact" class="sidebar-link">
        <i class="fa-solid fa-envelope"></i>
        <span>Contact</span>
      </a>

      <a href="#projects" class="sidebar-link">
        <i class="fa-solid fa-code"></i>
        <span>Projects</span>
      </a>
    </nav>

    <!-- Title bar -->
    <header
      class="sticky top-0 z-20 bg-light/85 dark:bg-dark/85 backdrop-blur-md border-b border-gray-200 dark:border-gray-700 transition-colors duration-300"
    >
      <div class="px-6 h-14 flex items-center justify-between">
        <h1 class="text-lg font-semibold">{title}</h1>

        <a
          href="/Sam_Popham_CV.pdf"
          download
          class="ml-4 inline-flex items-center px-3 py-1.5 rounded-md bg-blue-600 text-white text-sm font-medium hover:bg-blue-500"
          >Download CV</a
        >
      </div>
    </header>

    <!-- Page content -->
    <main class="relative z-10 md:ml-20">
      <slot />
    </main>

    {!noParticles && <script src="/scripts/particles.js" defer />}
  </body>
</html>
